<div class="panel panel-info">
  <div class="panel-heading">
    <h3 class="panel-title">Internship rankings</h3>
  </div>
  <div class="panel-body">
    <div class="panel-body">
      <div class="student-div student-internships">
        <% if can? :manage, Internship %>
          <div class="table-responsive">
            <table class="datatable table table-hover">
              <thead>
                <tr>
                  <th>Company</th>
                  <th>Rating</th>
                  <th>Notes</th>
                </tr>
              </thead>
              <tbody>
                <% @course.internships.each do |internship| %>
                  <tr>
                    <td class="col-xs-3"><%= link_to internship.name, course_internship_path(@course, internship) %></td>
                    <td class="col-xs-1"><p><%= set_rating_label(@student, internship) %></p></td>
                    <td class="col-xs-8"><p><%= @student.find_rating(internship).try(:notes) %></p></td>
                  </tr>
                <% end %>
              </tbody>
            </table>
          </div>
        <% elsif can? :read, Internship %>
          <p class="text-info">* You may only rank 3 companies as "Low" interest.</p>
          <%= form_for @student do |f| %>
            <%= render 'layouts/errors', object: @student %>
            <div class="row">
              <div class="col-xs-10">
                <table class="table">
                  <thead>
                    <tr>
                      <th>Company</th>
                      <th>Technologies</th>
                      <th>Rating</th>
                      <th>Notes</th>
                    </tr>
                  </thead>
                  <tbody>
                    <% @course.internships.each do |internship| %>
                      <tr id="internship_<%= internship.id %>">
                        <td class="col-xs-2">
                          <%= link_to internship.name, course_internship_path(@course, internship) %>
                          <p><%= set_rating_label(@student, internship) %></p>
                        </td>
                        <td class="col-xs-2"><%= internship.tracks.pluck(:description).join(', ') %></td>
                        <%= render 'ratings_fields', f: f, internship: internship %>
                      </tr>
                    <% end %>
                  </tbody>
                </table>
              </div>
              <% if @course.internships.any? %>
                <div class="col-xs-2">
                  <div class="form-group">
                    <%= f.submit 'Submit ratings', class: 'btn btn-success', id: 'fixed-ratings-button' %>
                  </div>
                </div>
              <% end %>
            </div>
          <% end %>
        <% end %>
      </div>
    </div>
  </div>
</div>
