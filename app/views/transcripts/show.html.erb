<div class="row">
  <div class="col-md-8 col-md-offset-2">
    <h1 class="text-center">Transcript for Epicodus</h1>
    <p class="text-center"><em><strong>Web and Mobile Development</strong></em></p>
    <p class="text-center">400 SW 6th Ave, Suite 800, Portland OR 97204</p>
    <p>Student: <strong><%= @student.name %></strong></p>
    <p>Dates Enrolled: <%= @student.courses.order(:start_date).first.start_date.strftime('%B %d, %Y') %> - <%= @student.courses.order(:start_date).last.end_date.strftime('%B %d, %Y') %></p>

    <p>Courses: <strong>(does not include courses in progress)</strong></p>
    <ul>
      <% @completed_courses.each do |course| %>
        <li>
          <%= course.description %>
          <ul>
            <% course.code_reviews.each do |code_review| %>
            <li>
              <%= code_review.title %>
              <span class="pull-right"><em><%= code_review.status(@student) %></em></span>
            </li>
            <% end %>
          </ul>
        </li>
      <% end %>
    </ul>

    <% if @completed_courses.non_internship_courses.any? %>
      <% if @student.total_attendance_score >= 90.0 %>
        <p>Epicodus requires students to attend class at least 90% of the time. This student met that requirement.</p>
      <% end %>

      <% if current_admin %>
        <div class='alert alert-warning'>
          <p>Attendance details (visible only to staff):</p>
          <p><strong>INCLUDES COMPLETED COURSES ONLY</strong></p>
          <ul>
            <li>Number of class days: <%= @completed_courses.map(&:class_days).flatten.count %></li>
            <li>Total attendance score: <%= @student.total_attendance_score.round(2) %>%</li>
            <li>Present <%= pluralize(@student.attendance_records_for(:all, @completed_courses.non_internship_courses.first, @completed_courses.non_internship_courses.last), 'day') %></li>
            <ul>
              <li>Tardy <%= pluralize(@student.attendance_records_for(:tardy, @completed_courses.non_internship_courses.first, @completed_courses.non_internship_courses.last), 'day') %></li>
              <li>Left early <%= pluralize(@student.attendance_records_for(:left_early, @completed_courses.non_internship_courses.first, @completed_courses.non_internship_courses.last), 'day') %></li>
            </ul>
            <li>Absent <%= pluralize(@student.attendance_records_for(:absent, @completed_courses.non_internship_courses.first, @completed_courses.non_internship_courses.last), 'day') %></li>
          </ul>
        </div>
      <% end %>
    <% end %>

    <p><%= image_tag "signature.png" %></p>
    <p><strong>Michael Kaiser-Nyman, President</strong></p>
    <p>Date: <%= @completed_courses.last.end_date.strftime('%B %d, %Y') %></p>
    <br>
    <p>Epicodus maintains student transcripts for 50 years.</p>
  </div>
</div>
